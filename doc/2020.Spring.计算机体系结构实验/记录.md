# 要求

**设计并实现一个流水线的RISC-V处理器核**

1. 支持完整的RV32I指令集和至少十条拓展指令（自定）

   指令集和编码方案，Deadline：6.23

2. 流水线不少于五级，支持Data Forwarding

   完成指定的测试程序，提交报告、源代码和模拟结果，Deadline：6.30

3. 支持分支预测（BPB和BTB二选一）

   完成指定的测试程序，提交报告、源代码和模拟结果，Deadline：7.7

4. 支持动态指令调度（记分牌和Tomasolu算法二选一）

   完成指定的测试程序，提交报告、源代码和模拟结果，Deadline：7.21

# 分析

要求比较清晰，按照最小工作量的原则来做就行。

RV32I指令集共40条指令，RV32M共8条指令，无法达到至少10条拓展指令的要求，考虑到后面的要求，决定用RV32IM两个子集，另外实现Zicsr和Zifencei这两个子集，共1（只用了一条CSRRS）+1=2条，总计50条。

流水线不少于5级，支持数据转发，考虑分支预测和Tomasolu算法，设置七级流水线：

PC→IF→ID→IS→EX→WB→Commit

PC为PC值生成的阶段，方便引入不同情况下PC值的计算；

IF为取值阶段，从内存中抓取一条指令；

ID为译码阶段，将指令解包，后期如果需要引入压缩指令，也在这个阶段添加；

IS为发射阶段，将指令发送到相应的保留站（如果没有结构冒险的话）；

EX为执行阶段，如果两个操作数都已就绪，就执行该条指令，未就绪则监听总线等待数据；

WB为写回阶段，将结果写回总线，等待的保留站和ROB接收，修改寄存机结果状态；

Commit为提交阶段，依照ROB表中顺序更新寄存器提交结果